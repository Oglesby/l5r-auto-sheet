<h2 class="ui header">Log</h2>
<div class="ui cards">
    <div class="ui log card" ng-repeat="logView in $ctrl.model.logViews">
        <div class="ui icon warning top attached message" ng-if="$ctrl.logViewIsInvalid(logView)">
            <i class="home icon"></i>
            <div class="content">
                <button class="ui right floated yellow button" ng-click="$ctrl.markHouseruled(logView)">Houserule</button>
                <div class="header">
                    This log isn't valid according to 4th Edition.
                </div>
                <p>Reason:
                    <ul>
                        <li ng-repeat="reason in logView.invalidReasons">{{reason}}</li>
                    </ul>
                </p>
                <p>You can edit it, or you can mark it as houseruled.</p>
            </div>
        </div>
        <div class="ui top attached content">
            <span class="header">{{logView.title}}</span> <span class="right floated meta">{{logView.creationTimestamp}}</span>
        </div>
        <div class="ui content" ng-if="$ctrl.editingLogView !== logView">
            <div ng-repeat="recordItem in logView.recordItems">
                {{recordItem.displayText}}
            </div>
        </div>
        <div class="ui content" ng-if="$ctrl.editingLogView === logView" ng-switch="logView.logModel.type">
            <div ng-switch-when="CREATION">
                <pi-add-edit-creation log-model="logView.logModel" on-save="$ctrl.finishEditingLog" on-cancel="$ctrl.cancelChangingLog"></pi-add-edit-creation>
            </div>
            <div ng-switch-when="CHARACTER_INFO">
                <pi-add-edit-character-details log-model="logView.logModel" on-save="$ctrl.finishEditingLog" on-cancel="$ctrl.cancelChangingLog"></pi-add-edit-character-details>
            </div>
            <div ng-switch-when="XP_EXPENDITURE">
                Can't be edited yet. <button class="ui button" ng-click="$ctrl.cancelChangingLog()">Cancel</button>
            </div>
            <div ng-switch-when="MODULE_COMPLETION">
                <pi-add-edit-log-module log-model="logView.logModel" on-save="$ctrl.finishEditingLog" on-cancel="$ctrl.cancelChangingLog"></pi-add-edit-log-module>
            </div>
        </div>
        <div class="content">
            <div class="ui right floated " ng-if="$ctrl.deletingLogView !== logView && $ctrl.editingLogView !== logView">
                <i class="large yellow home icon" ng-if="logView.isHouseruled"></i>
                <div class="ui buttons">
                    <button class="ui button" type="submit" ng-click="$ctrl.startEditLog(logView)" ng-disabled="$ctrl.deletingLogView || $ctrl.editingLogView">Edit</button>
                    <div class="or" ng-if="!$ctrl.isMandatoryEntry(logView)"></div>
                    <button class="ui button negative" ng-if="!$ctrl.isMandatoryEntry(logView)" ng-click="$ctrl.startDeleteLog(logView)" ng-disabled="$ctrl.deletingLogView || $ctrl.editingLogView">Delete</button>
                </div>
            </div>
            <div class="ui right floated" ng-if="$ctrl.deletingLogView === logView">
                <span style="padding-right: 5px">Are you sure you want to delete this log?</span>
                <div class="ui buttons">
                    <button class="ui button negative" type="submit" id="confirm-delete-item" name="confirm-delete-item" ng-click="$ctrl.finishDeletingLog()">Delete</button>
                    <div class="or"></div>
                    <button class="ui button" id="cancel-delete-item" name="cancel-delete-item" ng-click="$ctrl.cancelChangingLog()">Cancel</button>
                </div>
            </div>
        </div>
    </div>
</div>